# Antlr Syntax Highlighter

A work in progress simple syntax highlighter and code editor powered by [ANTLR](https://www.antlr.org/) grammars.

Given an antlr-generated lexer and a mapping from lexer-specific token ids to general token types, it is going to highlight the code without the need to install extra libraries.

<img width="700" src="/assets/preview.gif" />

## Sample Usage

First, we import some helpers from this project:

```jsx
import {
  CodeEditor,
  makeTokenizeFn,
  TOKEN_TYPES,
} from 'antlr-grammar-based-syntax-highlighter';
```

Next, we import our lexer [generated by ANTLR from the grammar file](https://github.com/antlr/antlr4/blob/master/doc/javascript-target.md) and we pick the highlighting style for each of the tokens.

```jsx
import { MyLanguageLexer } from 'antlr-generated-my-language-lexer-and-parser';

const TOKEN_MAPPING = new Map([
  [MyLanguageLexer.Integer, TOKEN_TYPES.NUMBER],
  [MyLanguageLexer.Identifier, TOKEN_TYPES.IDENTIFIER],
  [MyLanguageLexer.Return, TOKEN_TYPES.KEYWORD],
  [MyLanguageLexer.Break, TOKEN_TYPES.KEYWORD],
  [MyLanguageLexer.Continue, TOKEN_TYPES.KEYWORD],
  [MyLanguageLexer.LeftBrace, TOKEN_TYPES.BRACE],
  [MyLanguageLexer.RightBrace, TOKEN_TYPES.BRACE],
]);
```

Then, we generate a tokenize function that our code editor will use for code highlighting:

```jsx
const tokenize = makeTokenizeFn(MyLanguageLexer, TOKEN_MAPPING);
```

We're almost ready. Let's glue everything together with a custom component:

```jsx
const MyLanguageEditor = ({ code }) => {
  return <CodeEditor code={code} tokenize={tokenize} />;
};

export default MyLanguageEditor;
```

And finally, let's highlight some code with that component:

```jsx
import React from 'react';
import ReactDOM from 'react-dom';
import MyLanguageEditor from './MyLanguageEditor';

const code = 'return { id: 175 }';

ReactDOM.render(
  <MyLanguageEditor code={code} />,
  document.getElementById('root')
);
```

## Token Types

```js
const TOKEN_TYPES = {
  NONE: 'none',
  RAW: 'raw',
  IDENTIFIER: 'identifier',
  NUMBER: 'number',
  KEYWORD: 'keyword',
  BRACE: 'brace',
};
```

## Inspiration

- [Creating an Editable Textarea That Supports Syntax-Highlighted Code](https://css-tricks.com/creating-an-editable-textarea-that-supports-syntax-highlighted-code/)

## Local Setup

Clone the repository and execute the following commands in the project's dir from the terminal:

```bash
$ npm install --force
$ npm start # starts a server at localhost:3000
```

## Updating Grammar and generating JavaScript parser/lexer

An example grammar definition is located under `src/example/antlr/Lang.g4`. To generate Parser/Lexer/Listener javascript files, please run `make js` in the root dir of the project.

[ANTLR](https://www.antlr.org/) installation is required.
